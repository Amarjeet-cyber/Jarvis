<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Jarvis AI Assistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  /* Fullscreen background particle container */
  #tsparticles {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 0 !important;
    pointer-events: none;
    background-color: #0d1014;
  }
  html, body {
    margin: 0; padding: 0; height: 100%; width: 100%;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    overflow: hidden;
    background: #0d1014;
    color: white;
  }
  .assistant-ui {
    position: fixed;
    inset: 0;
    z-index: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: center;
    pointer-events: none;
  }
  .header {
    position: absolute;
    top: 40px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2.6em;
    color: #17c9fc;
    font-weight: 700;
    letter-spacing: 1.6px;
    pointer-events: all;
    user-select: none;
    text-shadow: 0 0 18px #17c9fccc, 0 3px 4px #f8b142cc;
  }
  .chatbox {
    width: 90vw;
    max-width: 600px;
    min-height: 320px;
    max-height: 65vh;
    margin-bottom: 15vh;
    background: rgba(30,40,60,0.8);
    border-radius: 25px;
    padding: 36px 32px 28px;
    overflow-y: auto;
    box-shadow: 0 0 48px #17c9fc44;
    pointer-events: all;
    scrollbar-width: thin;
    scrollbar-color: #303652 transparent;
  }
  .chatbox::-webkit-scrollbar {
    width: 8px;
  }
  .chatbox::-webkit-scrollbar-thumb {
    background-color: #303652;
    border-radius: 14px;
  }
  .msg {
    font-size: 1.15em;
    padding: 16px 24px;
    margin-bottom: 20px;
    max-width: 85%;
    border-radius: 16px;
    box-shadow: 0 3px 22px #1ababacc;
    line-height: 1.5;
    display: inline-block;
  }
  .msg.user {
    background: rgba(245,185,56,0.17);
    color: #fff5c2;
    float: right;
    text-align: right;
    clear: both;
  }
  .msg.bot {
    background: rgba(23,201,252,0.15);
    color: #b3f6ff;
    float: left;
    text-align: left;
    clear: both;
  }
  .clearfix {
    clear: both;
    height: 0;
  }
  form.input-bar {
    position: fixed;
    bottom: 5vh;
    left: 50%;
    transform: translateX(-50%);
    max-width: 600px;
    width: 92vw;
    display: flex;
    pointer-events: all;
  }
  form input {
    flex-grow: 1;
    font-size: 1.3em;
    padding: 16px 22px;
    border-radius: 18px;
    border: none;
    outline: none;
    background: rgba(23,201,252,0.13);
    color: #e2f8ff;
    box-shadow: 0 6px 24px #0008;
    margin-right: 14px;
  }
  form input:focus {
    background: rgba(23,201,252,0.23);
  }
  form button {
    background: linear-gradient(135deg, #17c9fc 20%, #f5b938 90%);
    border: none;
    border-radius: 50%;
    width: 58px;
    height: 58px;
    cursor: pointer;
    box-shadow: 0 6px 28px #17c9fcbb;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  form button:active {
    box-shadow: 0 8px 36px #f5b938ff;
  }
  /* Listening Waves */
  .wave {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 40px;
    height: 40px;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    pointer-events: none;
    visibility: hidden;
  }
  .wave-bar {
    width: 6px;
    height: 8px;
    background: #f5b938;
    border-radius: 6px;
    margin: 0 1.6px;
    animation: waveAnim 0.75s ease-in-out infinite;
  }
  .wave-bar:nth-child(2) {
    animation-delay: 0.09s;
  }
  .wave-bar:nth-child(3) {
    animation-delay: 0.18s;
  }
  .wave-bar:nth-child(4) {
    animation-delay: 0.27s;
  }
  .wave-bar:nth-child(5) {
    animation-delay: 0.36s;
  }
  @keyframes waveAnim {
    0%, 100% {
      height: 8px;
    }
    50% {
      height: 26px;
      background: #17c9fc;
    }
  }
  .listening .wave {
    visibility: visible;
  }
  /* Typing cursor */
  .cursor {
    display: inline-block;
    font-weight: 700;
    font-size: 1.15em;
    color: #f5b938;
    animation: blink 0.7s steps(1) infinite;
  }
  @keyframes blink {
    0%, 100% {opacity: 1;}
    50% {opacity: 0;}
  }
</style>
</head>
<body>

<div id="tsparticles"></div>

<div class="assistant-ui">
  <div class="header">Jarvis</div>
  <div class="chatbox" id="chatbox">
    <div class="msg bot">Hello, I am <b>Jarvis</b>. How can I assist?</div>
  </div>
  <form class="input-bar" id="form" autocomplete="off" onsubmit="handleSubmit(event)">
    <input id="textInput" placeholder="Type your question or command here..." autocomplete="off" />
    <button id="micBtn" type="button" title="Click to speak">
      <div id="wave" class="wave"></div>
      <svg fill="#fff" viewBox="0 0 24 24" height="30">
        <path d="M12 15c1.667 0 3-1.333 3-3v-5c0-1.667-1.333-3-3-3s-3 1.333-3 3v5c0 1.667 1.333 3 3 3zm5-3c0 
                2.775-2.225 5-5 5s-5-2.225-5-5h-2c0 3.307 2.542 
                6.032 5.763 6.472v2.028h2.474v-2.028c3.221-0.44 
                5.763-3.165 5.763-6.472h-2z"/>
      </svg>
    </button>
  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/tsparticles@3.3.0/tsparticles.bundle.min.js"></script>
<script>
  // Initialize tsParticles full-screen background
  tsParticles.load('tsparticles', {
    background: { color: { value: "#0d1014" } },
    fpsLimit: 60,
    particles: {
      number: { value: 80, density: { enable: true, value_area: 1200 } },
      color: { value: ["#17c9fc", "#f5b938", "#39ffcb", "#c583f6"] },
      shape: { type: "circle" },
      opacity: { value: 0.85 },
      size: { value: 6, random: { enable: true, minimumValue: 3 } },
      links: {
        enable: true,
        distance: 170,
        color: "#17c9fc",
        opacity: 0.3,
        width: 2,
        triangles: { enable: true, opacity: 0.06 }
      },
      move: {
        enable: true,
        speed: 1.7,
        random: true,
        outMode: "out",
        attract: { enable: true, rotateX: 800, rotateY: 1200 },
      }
    },
    interactivity: {
      events: {
        onhover: { enable: true, mode: "grab" },
        onclick: { enable: true, mode: "push" }
      },
      modes: {
        grab: { distance: 140, links: { opacity: 0.4 } },
        push: { quantity: 5 }
      }
    },
    detectRetina: true,
  });

  // Setup mic wave bars
  function setupWave() {
    const wave = document.getElementById('wave');
    wave.innerHTML = '';
    for(let i=0; i<5; ++i){
      let bar = document.createElement('div');
      bar.className = 'wave-bar';
      wave.appendChild(bar);
    }
  }
  setupWave();

  const micBtn = document.getElementById('micBtn');
  const chatbox = document.getElementById('chatbox');
  const form = document.getElementById('form');
  const textInput = document.getElementById('textInput');

  // Setup Web Speech API recognition if available
  let recognition;
  if ('webkitSpeechRecognition' in window) {
    recognition = new webkitSpeechRecognition();
  } else if ('SpeechRecognition' in window) {
    recognition = new SpeechRecognition();
  }

  if (recognition) {
    recognition.lang = 'en-IN';
    recognition.interimResults = false;
    recognition.continuous = false;

    recognition.onstart = () => micBtn.classList.add('listening');
    recognition.onend = () => micBtn.classList.remove('listening');
    recognition.onerror = () => {
      micBtn.classList.remove('listening');
      addMessage('bot', "I couldn't catch that. Please try again.");
    };
    recognition.onresult = (event) => {
      const text = event.results[0][0].transcript;
      addMessage('user', text);
      handleQuery(text);
    };
  }

  // Start speech recognition on mic click
  micBtn.onclick = () => {
    if (recognition) recognition.start();
    else alert('Speech Recognition not supported in your browser.');
  };

  // Typing animation
  function typeWriterEffect(element, text, delay = 17, cb) {
    element.innerHTML = '';
    let i = 0;
    function typing() {
      if (i < text.length) {
        element.innerHTML += text.charAt(i);
        const cursor = document.createElement('span');
        cursor.className = 'cursor';
        cursor.textContent = '|';
        element.appendChild(cursor);
        setTimeout(() => {
          cursor.remove();
          i++;
          typing();
        }, delay);
      } else {
        if(cb) cb();
      }
    }
    typing();
  }

  // Add chat message
  function addMessage(sender, text, typing = false) {
    const div = document.createElement('div');
    div.className = 'msg ' + sender;
    if (typing && sender === 'bot') {
      typeWriterEffect(div, text);
    } else {
      div.innerHTML = text;
    }
    chatbox.appendChild(div);
    chatbox.appendChild(document.createElement('div')).className = 'clearfix';
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  // Handle user queries (voice or text)
  function handleQuery(text) {
    text = text.toLowerCase().trim();

    if (text.startsWith('search for') || text.startsWith('google')) {
      const query = text.replace(/^search for|^google/, '').trim();
      if (query.length > 0) {
        addMessage('bot', `Searching Google for "${query}" ...`, true);

        fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json`)
          .then(r => r.json())
          .then(data => {
            const ans = data.AbstractText || data.RelatedTopics?.[0]?.Text || '';
            if(ans) addMessage('bot', ans, true);
            else {
              addMessage('bot', 'No instant answer found, opening browser for more.', true);
              window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
            }
          }).catch(() => {
            addMessage('bot', 'Could not fetch answer. Opening Google...', true);
            window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
          });
      }
    } else if (text.includes('youtube')) {
      addMessage('bot', 'Opening YouTube...', true);
      window.open('https://youtube.com', '_blank');
    } else if(text.includes('open') && text.includes('google')) {
      addMessage('bot', 'Opening Google...', true);
      window.open('https://google.com', '_blank');
    } else if (text.includes('time')) {
      addMessage('bot', 'Current time is ' + new Date().toLocaleTimeString(), true);
    } else if (/hello|hi|hey/.test(text)) {
      addMessage('bot', 'Hi! How can I help?', true);
    } else if (/your name|who are you/.test(text)) {
      addMessage('bot', "I'm Jarvis, your AI assistant.", true);
    } else if (text.length >= 3) {
      addMessage('bot', 'Let me look that up...', true);
      fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(text.split(' ').join('_'))}`)
        .then(r => r.json())
        .then(data => {
          if(data.extract) addMessage('bot', data.extract, true);
          else addMessage('bot', "Sorry, I couldn't find information on that.", true);
        }).catch(() => {
          addMessage('bot', "Sorry, an error occurred looking up the info.", true);
        });
    } else {
      addMessage('bot', 'Please ask a question or give a command.', true);
    }
  }

  // Text form submit handler
  function handleSubmit(e) {
    e.preventDefault();
    const val = textInput.value.trim();
    if(val) {
      addMessage('user', val);
      handleQuery(val);
      textInput.value = '';
    }
  }
  document.getElementById('form').onsubmit = handleSubmit;
</script>

</body>
</html>

